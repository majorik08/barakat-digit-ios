syntax = "proto3";

package coreledger;

option go_package = "core-ledger/api;coreledger";

service CoreLedger {
  rpc QuoteTransfer(QuoteTransferRequest) returns (QuoteTransferResponse);
  rpc PostTransfer(PostTransferRequest) returns (PostTransferResponse);
  rpc GetBalance(GetBalanceRequest) returns (GetBalanceResponse);
  rpc GetHistory(GetHistoryRequest) returns (GetHistoryResponse);
  rpc Reverse(ReverseRequest) returns (ReverseResponse);
  rpc GetLoanSchedule(GetLoanScheduleRequest) returns (GetLoanScheduleResponse);
}

message QuoteTransferRequest {
  string from_wallet_id = 1;
  string to_wallet_id = 2;
  string currency = 3;
  string amount = 4;
}

message QuoteTransferResponse {
  string fee = 1;
  string total = 2;
  string quote_id = 3;
  string expires_at = 4;
}

message PostTransferRequest {
  string quote_id = 1;
  string idempotency_key = 2;
  string from_wallet_id = 3;
  string to_wallet_id = 4;
  string currency = 5;
  string amount = 6;
}

message PostTransferResponse {
  string journal_id = 1;
  string status = 2;
}

message GetBalanceRequest {
  string wallet_id = 1;
  string currency = 2;
}

message GetBalanceResponse {
  string available = 1;
  string reserved = 2;
  string current = 3;
  string updated_at = 4;
}

message GetHistoryRequest {
  string wallet_id = 1;
  int32 limit = 2;
  string cursor = 3;
}

message GetHistoryResponse {
  repeated HistoryItem items = 1;
  string next_cursor = 2;
}

message HistoryItem {
  string id = 1;
  string type = 2;
  string amount = 3;
  string currency = 4;
  string direction = 5;
  string created_at = 6;
  string status = 7;
}

message ReverseRequest {
  string journal_id = 1;
  string reason = 2;
}

message ReverseResponse {
  string reversal_journal_id = 1;
  string status = 2;
}

message GetLoanScheduleRequest {
  string customer_id = 1;
}

message GetLoanScheduleResponse {
  repeated LoanScheduleItem items = 1;
}

message LoanScheduleItem {
  string loan_id = 1;
  string due_date = 2;
  string amount_due = 3;
  string status = 4;
}
